# AJAX

## AJAX?

Asynchronous JavaScript And XML
...이지만 요즘은 XML이 아니라 JSON을 더 많이 사용한다.

XMLHttpRequest 객체를 사용한다. 페이지 전체를 새고하지 않고 일부분만을 요청 받고 데이터를 받아 업데이트할 수 있다: **비동기성**

> XMLHttpRequest 객체
> 서버와 상호작용하기 위해 사용되는데, 새고 없이 데이터를 가져올 수 있다.



## Asynchronous JavaScript

### 동기식? 비동기식?

#### 동기식

순차적, 직렬적으로 일을 수행한다. 이전 요청에 대한 응답이 왔을 때 비로소 다음 요청을 날릴 수 있다.

#### 비동기식

병렬적으로 일을 수행한다. 요청에 대한 응답을 기다리지 않고 다음 동작이 이루어질 수 있다.



### 그럼 왜 비동기식을 쓸까?

데이터가 겁나 많은 앱을 실행할 때, 비동기식이라면 데이터를 요청하고 응답을 받는 동안 앱은 그대로 실행될 수가 있기 때문에 사용자 입장에서 화면이 보이는 게 더 기분이 조크든요... 동기식이라면 데이터 받아오는 동안 화면이 안 뜨고 앱이 멈춘 것처럼 보일 것이다.



### JS가 그게 가능해?

JS는 single threaded다. 컴퓨터가 여러 개의 CPU를 가지고 있어도 메인 스레드 하나에서만 작업이 가능하다. 그니까 이벤트를 처리하는 call stack이 하나라는 거지. 그래서 JS는 어떤 방법을 택했냐면

1. 즉시 처리하지 못하는 이벤트들을 다른 곳(Web API)으로 보내서 처리하게 하고,
2. 처리된 건 차례대로 Task queue에 다시 줄을 세워 놓고
3. call stack이 비면 event loop이 task queue에서 가장 앞에 서 있는 이벤트를 call stack으로 보낸다.



#### Web API

JS 엔진이 아닌 브라우저 영역에서 제공하는 API. 뭘 하냐면 AJAX로 데이터를 가져오는 시간이 소요되는 일들을 처리한다. 그 외에도 DOM events 등을 처리하긴 함.

근데 Web API로 들어오는 순서가 중요하지 않다. 어떤 게 먼저 처리되느냐가 중요하다. 비동기로 하고 있으니까. 그래서 순차적인 비동기를 위해 또 방법이 있는데... Async Callbacks와 promise-style이 그것들이다. 근데 전자는 함수의 깊이가 너무 깊어지는 callback hell에 떨어질 수 있다. 그래서 그걸 방지할 수 있는 promise-style을 쓰는 게 낫다.



> 일급객체
>
> JS 함수는 일급 객체다. 일급객체의 조건은 1. 인자로 넘길 수 있어야 하고 2. 함수의 반환 값으로 사용할 수 있어야 하고 3. 변수에 할당할 수 있어야 한다.



## Promise

리얼 약속이다... 내가 수행하면 이거 할 거고, 실패하면 이거 할 거야. 하고 적어두는 거다. 전자가 `.then(callback)`이고 후자가 `.catch(callback)`이다.



### Promise의 특징

1. callback 함수가 event loop이 현재 실행 중인 call stack을 완료하기 이전에는 절대 호출되지 않는다. 졸라 엄격한 순서로 호출됨
2. 비동기 작업이 성공/실패 중 어느 걸 해도 그 뒤에 `.then()` 메서드가 붙으면 1과 똑같이 동작한다
3. `.then()`을 여러 번 사용해서 여러 개의 callback 함수를 추가할 수 있다. ★



## Axios

promise를 쓰는 방식이 바로 axios다. 브라우저를 위한 promise 기반의 클라이언트.

